{% extends 'posts/base.html' %}
{% block content %}
  {% load static%}

  <head>
    <link rel="stylesheet" href="{% static 'css/photo_home.css' %}"/>
  </head>

  <body>
    <div class="content">
    {% if photo_page.state == "deactivate" %}
        <script type="text/javascript">
          alert('ì•„ì§ ìƒì¼ í˜ì´ì§€ê°€ í™œì„±í™”ë˜ì§€ ì•Šì•˜ì–´ìš”!')
          window.location.href = '{% url 'posts:main' %}';
        </script>
    {% elif photo_page.state == "activate" or photo_page.state == "archive" %}
        {% if photo_page.state == "archive" %}
          <div class="archive">
            <p>
              {{name}}ë‹˜ì˜
              {{year}}ë…„ í¬í†  ë°©ëª…ë¡ í˜ì´ì§€ì…ë‹ˆë‹¤.
            </p>

          </div>
          {%endif%}
          <div class="photo_icon">
            <img src="{% static 'img\icon\image-deactivate.png' %}" alt="">
          </div>
          <div class="text">
            <h1 class="text__title">í¬í† ë°©ëª…ë¡</h1>
            <p class="text__description">
              ì¶”ì–µì´ ë‹´ê¸´ ì‚¬ì§„ìœ¼ë¡œ</br>ì¶•í•˜ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!ğŸ‰
            </p>
          </div>
        <div class="images">
          {% if photos %}
            <div class="images__container">
              {% for photo in photos %}
                <div class="images__item">
                  <div class="images__item__sticker rotate"></div>
                  <!--<img class="images__item__pin rotate" src="{% static 'img/pin.png' %}" alt="">-->
                  {% if is_owner or request.user == photo.photo_uploader %}
                    {% if not photo_page.state == "archive" %}
                      <p class="images__item__delete-btn">
                        <button id={% url 'photos:photo_delete' photo.id %} class="delete-btn">
                          ì‚­ì œ
                        </button>
                      </p>
                    {% endif %}
                  {% else %}
                    <p class="images__item__delete-btn">
                      &nbsp;
                    </p>
                  {% endif %}
                  <div class="images__item__polaroid">
                    <p><img class="images__item__image" src=" {{photo.req_photo.url}}" alt=""></p>
                    <h3>{{photo.title}}</h3>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        {% else %}
          
          <div class="images--empty">
            <img src="{% static 'img\icon\empty-sad.png' %}" alt=""><br>
            ì•„ì§ ë‚¨ê²¨ì§„ í¬í†  ë°©ëª…ë¡ì´ ì—†ì–´ìš”.
          </div>
        {% endif %}
    {%endif %}
    </div>
      
      {% if not is_owner %}
        {% if not photo_page.state == "archive" %}
          {% if request.user.is_authenticated %}
            <a href="{% url 'photos:photo_create' year pk %}" class="floating-btn">
              <p class="floating-btn__text">í¬í†  ë°©ëª…ë¡ ë‚¨ê¸°ê¸°</p>
            </a>
          {% else %}
            <div class="floating-btn" id="login-btn">
              <p class="floating-btn__text">í¬í†  ë°©ëª…ë¡ ë‚¨ê¸°ê¸°</p>
            </div>
          {% endif %}
        {% endif %}
      {% endif %}

      {% if photo_page.state == "activate" or photo_page.state == "archive"%}
      <!-- í•˜ë‹¨ ë©”ë‰´ í‘œì‹œë˜ë„ë¡ í•˜ëŠ” ë¶€ë¶„. -->
      <div class="nav-bottom">
        <div class="nav-bottom__content">
          <a class="nav-bottom__content__birthdaypage" href="{% url 'posts:detail_birthday_page' target_birth.year target_birth.pk %}">
            <img src="{% static 'img\icon\birthday-cake-deactivate.png' %}" alt="">
            <h6>ì¶•í•˜ë©”ì„¸ì§€</h6>
          </a>
          <a class="nav-bottom__content__photo" href="{% url 'photos:photo_home' target_photo.year target_photo.photo_origin.pk %}">
            <img src="{% static 'img\icon\image-activate.png' %}" alt="">
            <h6>í¬í† ë°©ëª…ë¡</h6>
          </a>
          <a class="nav-bottom__content__tmi" href="{% url 'tmies:detail_tmi_page' target_tmi.year target_tmi.tmi_origin.pk%}">
            <img src="{% static 'img\icon\talking-deactivate.png' %}" alt="">
            <h6>ë‚´ ì¹œêµ¬ì˜ TMI</h6>
          </a>
        </div>
      </div>
  {%endif %}
  
  
</body>
<!-- ì´ë¯¸ì§€ í¬ê²Œ ë³´ê¸° ëª¨ë‹¬ -->
<div id="modal__images">
  <span class="modal__images--close"><img src="{% static 'img/icon/close.svg' %}" alt=""></span>
  <img class="modal__images__content" id="image-original">
</div>

<!--ì‚­ì œ ëª¨ë‹¬-->
<div class="modal__delete hidden">
  <div class="modal__delete__overlay"></div>
  <div class="modal__delete__content">
    <span class="modal__delete__content__title">ì •ë§ ì‚­ì œí•˜ì‹œê² ì–´ìš”?</span>
    <div class="modal__delete__content__description">
      ì‚­ì œí•œ í¬í†  ë°©ëª…ë¡ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”.
    </div>
    <div class="modal__delete__content__btns">
      <button class="modal__delete__cancel">ì·¨ì†Œ</button>
      <a href="" class="modal__delete__confirm">ì‚­ì œ</a>
    </div>
  </div>
</div>

<!-- ë¡œê·¸ì¸ ëª¨ë‹¬-->
<div class="modal__login hidden">
  <div class="modal__login__overlay"></div>
  <div class="modal__login__content">
    <span class="modal__login__content__title">ë¡œê·¸ì¸ í•˜ì§€ ì•Šê³ <br/>ë©”ì‹œì§€ë¥¼ ë‚¨ê¸°ì‹œê² ì–´ìš”?</span>
    <div class="modal__login__content__description">
      <h6>ë¡œê·¸ì¸ì„ í•˜ì§€ ì•Šìœ¼ë©´&nbsp</h6> 
      <div class="description__line">
        <h6>ë‚´ê°€ ë‚¨ê¸´&nbsp</h6>
        <h6>í¬í†  ë°©ëª…ë¡ì„&nbsp</h6>
      </div>
      <h6 class="bold">ì‚­ì œí•  ìˆ˜ ì—†ì–´ìš”.</h6>
    </div>
    <div class="modal__login__content__btns">
      <div class="login__social_login">
        <div class="login__yes">
          <a href="/login/?next={{ request.path }}" class="login__yes__text">ì†Œì…œ ë¡œê·¸ì¸ í•˜ëŸ¬ê°€ê¸°</a>
        </div>
        <div class="login__no" id="login__no">
          <a href="{% url 'photos:photo_create' year pk %}" class="login__no__text">ë¡œê·¸ì¸ ì—†ì´ ë‚¨ê¸°ê¸°</a>
        </div>
      </div>
      
    </div>
  </div>
</div>
<script>
  //ë‚˜ë¬´ì§‘ê²Œ ëœë¤ íšŒì „
  var randomList = [
    '-10',
    '-7',
    '-5',
    '5',
    '7',
    '10'
  ]
  const getRandom = (min, max) => Math.random() * (max - min) + min;
  var rand;
  var colors = ['#A7DD71', '#EDADDA', '#FF8F87', '#FFDA96', '#93B8E1']
  var pin = document.getElementsByClassName("rotate")
  for (i = 0; i < pin.length; i++) {
    //íšŒì „
    rand = randomList[Math.floor(Math.random() * randomList.length)];
    console.log(rand)
    pin[i].style.transform = 'rotate(' + rand + 'deg)';
    //ìƒ‰ë³€ê²½
    color = colors[i % 5]
    pin[i].style.backgroundColor = color;

  }

  //ì‚¬ì§„ í´ë¦­ ì‹œ í¬ê²Œ ë³´ê¸°
  var modalImages = document.getElementById("modal__images");

  // Get the image and insert it inside the modal - use its "alt" text as a caption
  var img = document.getElementsByClassName("images__item__image");
  var imgOriginal = document.getElementById("image-original");
  for (i = 0; i < img.length; i++) {
    img[i].onclick = function () {
      modalImages.style.display = "block";
      imgOriginal.src = this.src;
    }
  }

  var span = document.getElementsByClassName("modal__images--close")[0];
  span.onclick = function () {
    modalImages.style.display = "none";
  }
  var background = document.getElementById("modal__images");
  background.onclick = function () {
    modalImages.style.display = "none";
  }

  //ì‚­ì œ ëª¨ë‹¬
  const openButton = document.getElementsByClassName("delete-btn");
  const modalDelete = document.querySelector(".modal__delete");
  const cancelButton = modalDelete.querySelector(".modal__delete__cancel");
  const deleteButton = modalDelete.querySelector(".modal__delete__confirm");

  const openModalDelete = (e) => {
    deleteButton.href = e.target.id;
    modalDelete
      .classList
      .remove("hidden");
  }
  const cancelModalDelete = () => {
    modalDelete
      .classList
      .add("hidden");
  }

  for (i = 0; i < openButton.length; i++) {
    openButton[i].addEventListener("click", openModalDelete);
  }
  cancelButton.addEventListener("click", cancelModalDelete);

  //ë¡œê·¸ì¸ ëª¨ë‹¬
  const openButtonLogin = document.getElementById("login-btn");
  const modalLogin = document.querySelector(".modal__login");
  const closeButtonLogin = document.getElementById("login__no");

  const openModalLogin = () => {
    modalLogin.classList.remove("hidden");
  }
  const closeModalLogin = () => {
    modalLogin.classList.add("hidden");
  }
  
  openButtonLogin.addEventListener("click", openModalLogin);
  closeButtonLogin.addEventListener("click", closeModalLogin);

  const background_login = document.getElementsByClassName("modal__login__overlay")[0]
  background_login.onclick = function () {
    modalLogin.classList.add("hidden");
  }
</script>
{% endblock %}
